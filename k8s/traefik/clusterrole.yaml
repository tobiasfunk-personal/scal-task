apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: traefik
rules:
  - apiGroups: [""]
    resources: ["services", "endpoints", "secrets", "configmaps", "nodes"]
    verbs: ["get", "list", "watch"]
  - apiGroups: ["discovery.k8s.io"]
    resources: ["endpointslices"]
    verbs: ["get", "list", "watch"]
  - apiGroups: ["extensions", "networking.k8s.io"]
    resources: ["ingresses", "ingressclasses"]
    verbs: ["get", "list", "watch"]
  - apiGroups: ["networking.k8s.io"]
    resources: ["ingresses/status"]
    verbs: ["update"]
  # Traefik v2 CRDs (legacy group)
  - apiGroups: ["traefik.containo.us"]
    resources:
      [
        "ingressroutes",
        "ingressroutetcps",
        "ingressrouteudps",
        "middlewares",
        "middlewaretcps",
        "tlsoptions",
        "tlsstores",
        "traefikservices",
        "serverstransports",
        "serverstransporttcps"
      ]
    verbs: ["get", "list", "watch"]
  # Traefik v3 CRDs (current group)
  - apiGroups: ["traefik.io"]
    resources:
      [
        "ingressroutes",
        "ingressroutetcps",
        "ingressrouteudps",
        "middlewares",
        "middlewaretcps",
        "tlsoptions",
        "tlsstores",
        "traefikservices",
        "serverstransports",
        "serverstransporttcps"
      ]
    verbs: ["get", "list", "watch"]
